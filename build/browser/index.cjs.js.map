{"version":3,"file":"index.cjs.js","sources":["../module/request.js","../module/prototypes.js","../module/index.js"],"sourcesContent":["export class XOptions {\r\n    constructor(url, method = \"GET\", rt = \"text\", timeout) {\r\n        this.url = url;\r\n        this.method = method;\r\n        this.responseType = rt;\r\n        this.timeout = timeout;\r\n        this.headers = {};\r\n        this.requestedWith = true;\r\n    }\r\n}\r\nexport class XRequest {\r\n    constructor() {\r\n        this.xhr = new XMLHttpRequest();\r\n        this.promise = new Promise((resolve, reject) => {\r\n            this.resolve = resolve;\r\n            this.reject = reject;\r\n        });\r\n        this.convert = (d) => {\r\n            return d;\r\n        };\r\n    }\r\n    open(opts) {\r\n        if (!opts.hasOwnProperty('url'))\r\n            throw \"Missing 'url' Parameter\";\r\n        let method = opts.method;\r\n        this.xhr.open(method, opts.url);\r\n        this.xhr.responseType = opts.responseType;\r\n        this.xhr.onreadystatechange = this.__handleReadyStateChange.bind(this);\r\n        if (typeof opts.timeout === \"number\") {\r\n            this.xhr.timeout = opts.timeout;\r\n            this.xhr.ontimeout = this.__handleTimeout();\r\n        }\r\n    }\r\n    isPending() {\r\n        switch (this.xhr.readyState) {\r\n            case 0:\r\n            case 4: return false;\r\n            default: return true;\r\n        }\r\n    }\r\n    setHeader(k, v) {\r\n        this.xhr.setRequestHeader(k, v);\r\n    }\r\n    getPromise() {\r\n        return this.promise;\r\n    }\r\n    getResponse() {\r\n        return this.response;\r\n    }\r\n    getError() {\r\n        return this.error;\r\n    }\r\n    getStatus() {\r\n        return this.status;\r\n    }\r\n    hasError() {\r\n        return this.error !== undefined;\r\n    }\r\n    send(data) {\r\n        if (data === undefined)\r\n            return this.xhr.send();\r\n        return this.xhr.send(data);\r\n    }\r\n    abort() {\r\n        if (this.xhr.readyState === 4 || this.xhr.readyState === 0)\r\n            return;\r\n        return this.xhr.abort();\r\n    }\r\n    __handleReadyStateChange() {\r\n        switch (this.xhr.readyState) {\r\n            case XMLHttpRequest.DONE: return this.__handleDone();\r\n        }\r\n    }\r\n    __handleDone() {\r\n        if (this.xhr.status === 200)\r\n            return this.__handleSuccess();\r\n        if (this.xhr.status === 0)\r\n            return this.__handleAborted();\r\n        return this.__handleError();\r\n    }\r\n    __handleSuccess() {\r\n        switch (this.xhr.responseType) {\r\n            case \"arraybuffer\":\r\n                let buffer = this.xhr.response;\r\n                if (buffer) {\r\n                    this.response = this.convert(new Uint8Array(buffer), this);\r\n                    this.status = this.xhr.status;\r\n                }\r\n                else {\r\n                    this.response = this.convert(new Uint8Array(0), this);\r\n                    this.status = this.xhr.status;\r\n                }\r\n                this.onSuccess();\r\n                break;\r\n            case \"json\":\r\n                this.response = this.convert(this.xhr.response, this);\r\n                this.status = this.xhr.status;\r\n                this.onSuccess();\r\n                break;\r\n            default:\r\n                this.response = this.convert(this.xhr.responseText, this);\r\n                this.status = this.xhr.status;\r\n                this.onSuccess();\r\n                break;\r\n        }\r\n    }\r\n    __handleError() {\r\n        this.error = this.xhr.response;\r\n        this.status = this.xhr.status;\r\n        this.onError();\r\n    }\r\n    __handleAborted() {\r\n        this.error = \"aborted\";\r\n        this.status = 0;\r\n        this.onAbort();\r\n    }\r\n    __handleTimeout() {\r\n        this.error = \"timeout\";\r\n        this.status = this.xhr.status;\r\n        this.onTimeout();\r\n    }\r\n    onSuccess() {\r\n        this.resolve(this);\r\n    }\r\n    onError() {\r\n        this.reject(this);\r\n    }\r\n    onAbort() {\r\n        this.reject(this);\r\n    }\r\n    onTimeout() {\r\n        this.reject(this);\r\n    }\r\n}\r\n//# sourceMappingURL=request.js.map","import { XRequest } from \"./request\";\r\nexport function isBinarySerializer(object) {\r\n    return 'serializeBinary' in object && typeof object.serializeBinary === \"function\";\r\n}\r\nexport function isBinaryDeserializer(object) {\r\n    return 'deserializeBinary' in object && typeof object.deserializeBinary === \"function\";\r\n}\r\nexport function XText(url, options) {\r\n    let request = new XRequest();\r\n    let opts = Object.create(options);\r\n    opts.url = url;\r\n    let data = opts.data ? opts.data : undefined;\r\n    if (opts.data !== null && opts.data !== undefined) {\r\n        opts.method = \"POST\";\r\n    }\r\n    request.open(opts);\r\n    setTextHeaders(request, opts);\r\n    setHeaders(request, opts);\r\n    setFunctionOverrides(request, opts);\r\n    request.send(data);\r\n    return request;\r\n}\r\nexport function XJson(url, options) {\r\n    let request = new XRequest();\r\n    let opts = Object.create(options);\r\n    opts.url = url;\r\n    opts.responseType = \"json\";\r\n    let data = opts.data ? opts.data : undefined;\r\n    if (opts.data !== null && opts.data !== undefined) {\r\n        opts.method = \"POST\";\r\n    }\r\n    request.open(opts);\r\n    setJSONHeaders(request, opts);\r\n    setHeaders(request, opts);\r\n    setFunctionOverrides(request, opts);\r\n    request.send(data);\r\n    return request;\r\n}\r\nexport function XProto(url, options) {\r\n    let request = new XRequest();\r\n    let opts = Object.create(options);\r\n    opts.url = url;\r\n    opts.responseType = \"arraybuffer\";\r\n    let data = opts.data ? opts.data : undefined;\r\n    if (opts.data !== null && opts.data !== undefined) {\r\n        opts.method = \"POST\";\r\n    }\r\n    request.open(opts);\r\n    setProtoHeaders(request, opts);\r\n    setHeaders(request, opts);\r\n    setProtoConvert(request, opts);\r\n    setFunctionOverrides(request, opts);\r\n    if (isBinarySerializer(data)) {\r\n        request.send(data.serializeBinary());\r\n    }\r\n    else {\r\n        request.send(data);\r\n    }\r\n    return request;\r\n}\r\nfunction setHeaders(request, options) {\r\n    if (options.hasOwnProperty('headers'))\r\n        return;\r\n    for (let key in options.headers) {\r\n        request.setHeader(key, options.headers[key]);\r\n    }\r\n}\r\nfunction setXRequestedWithHeader(request, options) {\r\n    if (!options.hasOwnProperty('requestedWith') || options.requestedWith) {\r\n        request.setHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n    }\r\n}\r\nfunction setTextHeaders(request, options) {\r\n    setXRequestedWithHeader(request, options);\r\n    request.setHeader(\"Content-Type\", \"text/plain\");\r\n}\r\nfunction setJSONHeaders(request, options) {\r\n    setXRequestedWithHeader(request, options);\r\n    request.setHeader(\"Content-Type\", \"application/json\");\r\n}\r\nfunction setProtoHeaders(request, options) {\r\n    setXRequestedWithHeader(request, options);\r\n    request.setHeader(\"Content-Types\", \"application/octet-stream\");\r\n}\r\nfunction setFunctionOverrides(request, options) {\r\n    if (options.hasOwnProperty('convert'))\r\n        request.convert = options.convert;\r\n}\r\nfunction setProtoConvert(request, options) {\r\n    if (!options.hasOwnProperty('proto'))\r\n        request.convert = buildProtoConvert(options.proto);\r\n}\r\nfunction buildProtoConvert(proto) {\r\n    return function (data) {\r\n        return proto.deserializeBinary(data);\r\n    };\r\n}\r\n//# sourceMappingURL=prototypes.js.map","import { XJson, XText, XProto } from \"./prototypes\";\r\nimport { XRequest } from \"./request\";\r\nexport default class X {\r\n    static text(url, options) {\r\n        return XText(url, options);\r\n    }\r\n    static json(url, options) {\r\n        return XJson(url, options);\r\n    }\r\n    static proto(url, options) {\r\n        return XProto(url, options);\r\n    }\r\n    static abort(request) {\r\n        if (request instanceof XRequest) {\r\n            request.abort();\r\n        }\r\n    }\r\n    static isPending(request) {\r\n        if (request instanceof XRequest) {\r\n            return request.isPending();\r\n        }\r\n        return false;\r\n    }\r\n    static new() {\r\n        return new XRequest();\r\n    }\r\n}\r\nexport { XRequest, XOptions } from \"./request\";\r\n//# sourceMappingURL=index.js.map"],"names":["XOptions","url","method","rt","timeout","responseType","headers","requestedWith","XRequest","xhr","XMLHttpRequest","promise","Promise","resolve","reject","convert","d","opts","hasOwnProperty","open","onreadystatechange","__handleReadyStateChange","bind","ontimeout","__handleTimeout","readyState","k","v","setRequestHeader","response","error","status","undefined","data","send","abort","DONE","__handleDone","__handleSuccess","__handleAborted","__handleError","buffer","Uint8Array","onSuccess","responseText","onError","onAbort","onTimeout","isBinarySerializer","object","serializeBinary","XText","options","request","Object","create","XJson","XProto","setHeaders","key","setHeader","setXRequestedWithHeader","setTextHeaders","setJSONHeaders","setProtoHeaders","setFunctionOverrides","setProtoConvert","buildProtoConvert","proto","deserializeBinary","X","isPending"],"mappings":"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"}