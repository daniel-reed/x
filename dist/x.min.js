!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.x=t()}(this,function(){"use strict";!function(){function e(e){this.value=e}function t(t){function r(o,s){try{var i=t[o](s),a=i.value;a instanceof e?Promise.resolve(a.value).then(function(e){r("next",e)},function(e){r("throw",e)}):n(i.done?"return":"normal",i.value)}catch(e){n("throw",e)}}function n(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}(o=o.next)?r(o.key,o.arg):s=null}var o,s;this._invoke=function(e,t){return new Promise(function(n,i){var a={key:e,arg:t,resolve:n,reject:i,next:null};s?s=s.next=a:(o=s=a,r(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}();var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),r=function(){function r(){e(this,r)}return t(r,null,[{key:"text",value:function(e,t){var o=new n,s={type:"POST",url:e};Object.assign(s,t),o.open(s),r.setTextHeaders(o,s),r.setHeaders(o,s),r.setFunctionOverrides(o,s);var i=s.hasOwnProperty("data")?s.data:void 0;return o.send(i),r.returnRequestOrPromise(o,t)}},{key:"json",value:function(e,t){var o=new n,s={type:"POST",url:e,responseType:"json"};Object.assign(s,t),o.open(s),r.setJSONHeaders(o,s),r.setHeaders(o,s),r.setFunctionOverrides(o,s);var i=s.hasOwnProperty("data")?JSON.stringify(s.data):void 0;return o.send(i),r.returnRequestOrPromise(o,t)}},{key:"proto",value:function(e,t){var o=new n,s={type:"POST",url:e,responseType:"json"};Object.assign(s,t),o.open(s),r.setProtoHeaders(o,s),r.setHeaders(o,s),r.setFunctionOverrides(o,s),r.setProtoConvert(o,s);var i=void 0;return s.hasOwnProperty("data")&&s.data.hasOwnProperty("serializeBinary")&&(i=s.data.serializeBinary()),o.send(i),r.returnRequestOrPromise(o,t)}},{key:"setJSONHeaders",value:function(e,t){r.setXRequestedWithHeader(e,t),e.setHeader("Content-Type","application/json")}},{key:"setTextHeaders",value:function(e,t){r.setXRequestedWithHeader(e,t),e.setHeader("Content-Type","text/plain")}},{key:"setProtoHeaders",value:function(e,t){r.setXRequestedWithHeader(e,t),e.setHeader("Content-Type","application/octet-stream")}},{key:"setXRequestedWithHeader",value:function(e,t){t.hasOwnProperty("requestedWith")&&!t.requestedWith||e.setHeader("X-Requested-With","XMLHttpRequest")}},{key:"setHeaders",value:function(e,t){if(!t.hasOwnProperty("headers"))for(var r in t.headers)t.headers.hasOwnProperty(r)&&e.setHeader(r,t.headers[r])}},{key:"setFunctionOverrides",value:function(e,t){t.hasOwnProperty("convert")&&(e.convert=t.convert),t.hasOwnProperty("success")&&(e.success=t.success),t.hasOwnProperty("error")&&(e.error=t.error),t.hasOwnProperty("aborted")&&(e.aborted=t.aborted),t.hasOwnProperty("timeout")&&(e.timeout=t.timeout)}},{key:"setProtoConvert",value:function(e,t){t.hasOwnProperty("proto")&&(e.convert=r.buildProtoConvert(t.proto))}},{key:"isPending",value:function(e){return null!==e&&(void 0!==e&&(!!e.hasOwnProperty("isPending")&&e.isPending()))}},{key:"abort",value:function(e){if(null!==e&&void 0!==e&&e.hasOwnProperty("abort"))return e.abort()}},{key:"buildProtoConvert",value:function(e){return function(t,r){return e.deserializeBinary(t)}}},{key:"returnRequestOrPromise",value:function(e,t){switch(t.returnType){case"promise":return e.getPromise();default:return e}}}]),r}(),n=function t(){var r=this;e(this,t),this.open=function(e){if(!e.hasOwnProperty("url"))throw"Missing 'url' Parameter";var t=e.hasOwnProperty("type")?e.type:"GET";r.xhr.open(t,e.url),e.hasOwnProperty("responseType")&&(r.xhr.responseType=e.responseType),r.xhr.onreadystatechange=r.__handleReadyStateChange,e.hasOwnProperty("timeout")&&(r.xhr.timeout=e.timeout,r.xhr.ontimeout=r.__handleTimeout())},this.isPending=function(){switch(r.xhr.readyState){case 0:case 4:return!1;default:return!0}},this.setHeader=function(e,t){r.xhr.setRequestHeader(e,t)},this.getPromise=function(){return r.promise},this.send=function(e){return void 0===e?r.xhr.send():r.xhr.send(e)},this.abort=function(){if(4!==r.xhr.readyState&&0!==r.xhr.readyState)return r.xhr.abort()},this.__handleReadyStateChange=function(){switch(r.xhr.readyState){case XMLHttpRequest.DONE:return r.__handleDone()}},this.__handleDone=function(){return 200===r.xhr.status?r.__handleSuccess():0===r.xhr.status?r.__handleAborted():r.__handleError()},this.__handleSuccess=function(){switch(r.xhr.responseType){case"json":r.success(r.convert(r.xhr.response),r);break;default:r.success(r.convert(r.xhr.responseText),r)}},this.__handleError=function(){r.error(r.xhr.response,r,r.xhr.status)},this.__handleAborted=function(){r.aborted(r)},this.__handleTimeout=function(){r.timeout(r)},this.convert=function(e,t){return e},this.success=function(e,t){t.resolve(t)},this.error=function(e,t,r){t.reject(t)},this.aborted=function(e){e.reject(e)},this.timeout=function(e){e.reject(e)},this.xhr=new XMLHttpRequest,this.promise=new Promise(function(e,t){r.resolve=e,r.reject=t})};return r});
