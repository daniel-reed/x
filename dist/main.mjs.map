{"version":3,"file":"main.mjs","sources":["../src/main.js"],"sourcesContent":["export default class x {\r\n    static text(url, options) {\r\n        let request = new Request();\r\n        let opts = {type: \"POST\", url: url};\r\n        Object.assign(opts, options);\r\n        request.open(opts);\r\n\r\n        x.setTextHeaders(request, opts);\r\n        x.setHeaders(request, opts);\r\n        x.setFunctionOverrides(request, opts);\r\n\r\n        let data = opts.hasOwnProperty('data') ? opts.data : undefined;\r\n        request.send(data);\r\n    }\r\n\r\n    static json(url, options) {\r\n        let request = new Request();\r\n        let opts = {type: \"POST\", url: url, responseType: \"json\"};\r\n        Object.assign(opts, options);\r\n        request.open(opts);\r\n\r\n        x.setJSONHeaders(request, opts);\r\n        x.setHeaders(request, opts);\r\n        x.setFunctionOverrides(request, opts);\r\n\r\n        let data = opts.hasOwnProperty('data') ? JSON.stringify(opts.data) : undefined;\r\n        request.send(data);\r\n    }\r\n\r\n    static proto(url, options) {\r\n        let request = new Request();\r\n        let opts = {type: \"POST\", url: url, responseType: \"json\"};\r\n        Object.assign(opts, options);\r\n        request.open(opts);\r\n\r\n        x.setProtoHeaders(request, opts);\r\n        x.setHeaders(request, opts);\r\n        x.setFunctionOverrides(request, opts);\r\n        x.setProtoConvert(request, opts);\r\n\r\n        let data;\r\n        if (opts.hasOwnProperty('data') && opts.data.hasOwnProperty('serializeBinary')) {\r\n            data = opts.data.serializeBinary();\r\n        }\r\n        request.send(data);\r\n    }\r\n\r\n    static setJSONHeaders(request, options) {\r\n        x.setXRequestedWithHeader(request, options);\r\n        request.setHeader(\"Content-Type\", \"application/json\");\r\n    }\r\n\r\n    static setTextHeaders(request, options) {\r\n        x.setXRequestedWithHeader(request, options);\r\n        request.setHeader(\"Content-Type\", \"text/plain\");\r\n    }\r\n\r\n    static setProtoHeaders(request, options) {\r\n        x.setXRequestedWithHeader(request, options);\r\n        request.setHeader(\"Content-Type\", \"application/octet-stream\")\r\n    }\r\n\r\n    static setXRequestedWithHeader(request, options) {\r\n        if (!options.hasOwnProperty('requestedWith') || options.requestedWith) {\r\n            request.setHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n        }\r\n    }\r\n\r\n    static setHeaders(request, options) {\r\n        if (options.hasOwnProperty('headers')) return;\r\n\r\n        for (let key in options.headers) {\r\n            if (!options.headers.hasOwnProperty(key)) continue;\r\n            request.setHeader(key, options.headers[key]);\r\n        }\r\n    }\r\n\r\n    static setFunctionOverrides(request, options) {\r\n        if (options.hasOwnProperty('convert')) request.convert = options.convert;\r\n        if (options.hasOwnProperty('success')) request.success = options.success;\r\n        if (options.hasOwnProperty('error')) request.error = options.error;\r\n        if (options.hasOwnProperty('aborted')) request.aborted = options.aborted;\r\n        if (options.hasOwnProperty('timeout')) request.timeout = options.timeout;\r\n    }\r\n\r\n    static setProtoConvert(request, options) {\r\n        if (!options.hasOwnProperty('proto')) return;\r\n        request.convert = x.buildProtoConvert(options.proto);\r\n    }\r\n\r\n    static isPending(request) {\r\n        if (request === null) return false;\r\n        if (request === undefined) return false;\r\n        if (!request.hasOwnProperty('isPending')) return false;\r\n        return request.isPending();\r\n    }\r\n\r\n    static abort(request) {\r\n        if (request === null) return;\r\n        if (request === undefined) return;\r\n        if (!request.hasOwnProperty('abort')) return;\r\n        return request.abort();\r\n    }\r\n\r\n    static buildProtoConvert(proto) {\r\n        return function (data, _this) {\r\n            return proto.deserializeBinary(data);\r\n        }\r\n    }\r\n}\r\n\r\nclass Request {\r\n    constructor() {\r\n        this.xhr = new XMLHttpRequest();\r\n    }\r\n\r\n    open = (opts) => {\r\n        if (!opts.hasOwnProperty('url')) throw \"Missing 'url' Parameter\";\r\n\r\n        let type = opts.hasOwnProperty(\"type\") ? opts.type : \"GET\";\r\n\r\n        this.xhr.open(type, opts.url);\r\n\r\n        if (opts.hasOwnProperty(\"responseType\")) this.xhr.responseType = opts.responseType;\r\n        this.xhr.onreadystatechange = this.__handleReadyStateChange;\r\n        if (opts.hasOwnProperty(\"timeout\")) {\r\n            this.xhr.timeout = opts.timeout;\r\n            this.xhr.ontimeout = this.__handleTimeout();\r\n        }\r\n    }\r\n\r\n    isPending = () => {\r\n        switch (this.xhr.readyState) {\r\n            case 0: case 4: return false;\r\n            default: return true;\r\n        }\r\n    }\r\n\r\n    setHeader = (k, v) => {\r\n        this.xhr.setRequestHeader(k, v);\r\n    }\r\n\r\n    send = (data) => {\r\n        if (data === undefined) return this.xhr.send();\r\n        return this.xhr.send(data);\r\n    }\r\n\r\n    abort = () => {\r\n        if (this.xhr.readyState === 4 || this.xhr.readyState === 0) return;\r\n        return this.xhr.abort();\r\n    }\r\n\r\n    __handleReadyStateChange = () => {\r\n        switch (this.xhr.readyState) {\r\n            case XMLHttpRequest.DONE: return this.__handleDone();\r\n        }\r\n    }\r\n\r\n    __handleDone = () => {\r\n        if (this.xhr.status === 200) return this.__handleSuccess();\r\n        if (this.xhr.status === 0) return this.__handleAborted();\r\n        return this.__handleError();\r\n    }\r\n\r\n    __handleSuccess = () => {\r\n        switch (this.xhr.responseType) {\r\n            case \"json\":\r\n                this.success(this.convert(this.xhr.response), this);\r\n                break;\r\n            default:\r\n                this.success(this.convert(this.xhr.responseText), this);\r\n                break;\r\n        }\r\n    }\r\n\r\n    __handleError = () => {\r\n        this.error(this.xhr.response, this, this.xhr.status)\r\n    }\r\n\r\n    __handleAborted = () => {\r\n        this.aborted(this);\r\n    }\r\n\r\n    __handleTimeout = () => {\r\n        this.timeout(this);\r\n    }\r\n\r\n    convert = function (data, _this) {return data;}\r\n\r\n    success = function (response, _this) {}\r\n\r\n    error = function (response, _this , status) {}\r\n\r\n    aborted = function (_this) {}\r\n\r\n    timeout = function (_this) {}\r\n}\r\n\r\n"],"names":["x","url","options","request","Request","opts","type","assign","open","setTextHeaders","setHeaders","setFunctionOverrides","data","hasOwnProperty","undefined","send","responseType","setJSONHeaders","JSON","stringify","setProtoHeaders","setProtoConvert","serializeBinary","setXRequestedWithHeader","setHeader","requestedWith","key","headers","convert","success","error","aborted","timeout","buildProtoConvert","proto","isPending","abort","_this","deserializeBinary","xhr","onreadystatechange","__handleReadyStateChange","ontimeout","__handleTimeout","readyState","k","v","setRequestHeader","XMLHttpRequest","DONE","__handleDone","status","__handleSuccess","__handleAborted","__handleError","response","responseText"],"mappings":"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"}